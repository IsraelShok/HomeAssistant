[{"id":"fa4a0d7b.da59d","type":"debug","z":"8436a552.ae1f78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":370,"y":260,"wires":[]},{"id":"76a6be1f.4118d","type":"catch","z":"8436a552.ae1f78","name":"","scope":null,"x":120,"y":260,"wires":[["fa4a0d7b.da59d"]]},{"id":"20636f59.fed13","type":"telegram event","z":"8436a552.ae1f78","name":"","bot":"c3670dce.18aa8","event":"callback_query","autoanswer":true,"x":140,"y":380,"wires":[["2c6089c4.883006","43cecef5.e2e93"]]},{"id":"d0ae190d.071828","type":"telegram sender","z":"8436a552.ae1f78","name":"show inline keyboard","bot":"c3670dce.18aa8","x":582.7594223022461,"y":313.3033103942871,"wires":[["23220303.4a427c"]]},{"id":"3426758a.a2d09a","type":"function","z":"8436a552.ae1f78","name":"initial inline keyboard message","func":"context.global.keyboard = { messageId : msg.payload.messageId };\n\nvar opts = {\n  reply_to_message_id: msg.payload.messageId,\n  reply_markup: JSON.stringify({\n    \"inline_keyboard\": [[\n                {\n                    \"text\": \"Yes\",\n                    \"callback_data\": \"FOO YES\"            \n                }, \n                {\n                    \"text\": \"No\",\n                    \"callback_data\": \"FOO NO\"            \n                }]\n            ]\n  })\n};\n\nmsg.payload.content = 'Do you want to hide the inline keyboard?';\nmsg.payload.options = opts;\n\nreturn [ msg ];\n","outputs":"1","noerr":0,"x":321.7592468261719,"y":314.3032283782959,"wires":[["d0ae190d.071828"]]},{"id":"d7bfbd4.da4e34","type":"telegram command","z":"8436a552.ae1f78","name":"/foo","command":"/foo","bot":"c3670dce.18aa8","strict":false,"hasresponse":false,"x":102.75931549072266,"y":320.3032102584839,"wires":[["3426758a.a2d09a"]]},{"id":"43cecef5.e2e93","type":"function","z":"8436a552.ae1f78","name":"evaluate callback query","func":"// This is a sample switch to demonstrate the handling of the user input.\nif(msg.payload.content === \"FOO YES REALLY\")\n{\n    // Hide the keyboard and forget the messageId\n    msg.payload.type = 'deleteMessage';\n    msg.payload.content = context.global.keyboard.messageId\n    context.global.keyboard.messageId = null;\n    \n    // You could also send a editMessageReplyMarkup with an empty reply_markup here\n    return [ null, msg ];\n}\nelse\n{\n    var show_alert = false; // you can set this to true to open a dialog with the answer in the client.\n    \n    // msg.payload.content contains the callback data from the keyboard.\n    // You may change this value here.\n    msg.payload.options = show_alert;\n    \n    return [ msg, null ];\n}","outputs":"2","noerr":0,"x":468.75933837890625,"y":448.3309726715088,"wires":[["8e746981.f48368"],["8e746981.f48368"]]},{"id":"8e746981.f48368","type":"telegram sender","z":"8436a552.ae1f78","name":"answer callback query","bot":"c3670dce.18aa8","x":812.7593231201172,"y":379.33101081848145,"wires":[[]]},{"id":"2c6089c4.883006","type":"function","z":"8436a552.ae1f78","name":"edit inline keyboard message","func":"// This is the message id of the initial keyboard that is simply exchanged by a new one.\nvar messageId = context.global.keyboard.messageId;\n\n// This is a sample of how to send a second inline keyboard with modified buttons\nvar reply_markup = JSON.stringify({\n    \"inline_keyboard\": [[\n                {\n                    \"text\": \"Are you really sure?\",\n                    \"callback_data\": \"FOO YES REALLY\"            \n                }, \n                {\n                    \"text\": \"No\",\n                    \"callback_data\": \"FOO NO\"            \n                }]\n            ]\n  });\n\n\nvar options = {\n    chat_id : msg.payload.chatId,\n    reply_markup : reply_markup,\n    message_id : messageId\n};\n\nmsg.payload.type = 'editMessageReplyMarkup';\nmsg.payload.content = reply_markup;\nmsg.payload.options = options;\n\nreturn [ msg ];\n","outputs":"1","noerr":0,"x":475.00010681152344,"y":381.00000762939453,"wires":[["8e746981.f48368"]]},{"id":"23220303.4a427c","type":"function","z":"8436a552.ae1f78","name":"save messageId","func":"// We store the messageId to be able to edit this reply in the callback query. \ncontext.global.keyboard.messageId = msg.payload.sentMessageId;\nreturn [ msg ];\n","outputs":"1","noerr":0,"x":800.6667861938477,"y":313.6667127609253,"wires":[[]]},{"id":"c3670dce.18aa8","type":"telegram bot","z":"","botname":"HeinzBot","usernames":"","chatids":"","baseapiurl":"","updatemode":"polling","pollinterval":"300","usesocks":false,"sockshost":"","socksport":"","socksusername":"anonymous","sockspassword":"","bothost":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"sslterminated":false,"verboselogging":true}]